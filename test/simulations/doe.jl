@testset "Factorials" begin
    tlf = TwoLevelFactorial()

    @test doe_samples(tlf, 2) == [
        1.0 1.0
        1.0 0.0
        0.0 1.0
        0.0 0.0
    ]
    @test doe_samples(tlf, 3) == [
        1.0 1.0 1.0
        1.0 1.0 0.0
        1.0 0.0 1.0
        1.0 0.0 0.0
        0.0 1.0 1.0
        0.0 1.0 0.0
        0.0 0.0 1.0
        0.0 0.0 0.0
    ]
    @test doe_samples(tlf, 4) == [
        1.0 1.0 1.0 1.0
        1.0 1.0 1.0 0.0
        1.0 1.0 0.0 1.0
        1.0 1.0 0.0 0.0
        1.0 0.0 1.0 1.0
        1.0 0.0 1.0 0.0
        1.0 0.0 0.0 1.0
        1.0 0.0 0.0 0.0
        0.0 1.0 1.0 1.0
        0.0 1.0 1.0 0.0
        0.0 1.0 0.0 1.0
        0.0 1.0 0.0 0.0
        0.0 0.0 1.0 1.0
        0.0 0.0 1.0 0.0
        0.0 0.0 0.0 1.0
        0.0 0.0 0.0 0.0
    ]

    ff = FullFactorial([3, 4, 2])
    @test ff.levels == [3, 4, 2]
    @test doe_samples(ff, 3) == [
        0.0 0.0 0.0
        0.0 0.0 1.0
        0.0 0.3333333333333333 0.0
        0.0 0.3333333333333333 1.0
        0.0 0.6666666666666666 0.0
        0.0 0.6666666666666666 1.0
        0.0 1.0 0.0
        0.0 1.0 1.0
        0.5 0.0 0.0
        0.5 0.0 1.0
        0.5 0.3333333333333333 0.0
        0.5 0.3333333333333333 1.0
        0.5 0.6666666666666666 0.0
        0.5 0.6666666666666666 1.0
        0.5 1.0 0.0
        0.5 1.0 1.0
        1.0 0.0 0.0
        1.0 0.0 1.0
        1.0 0.3333333333333333 0.0
        1.0 0.3333333333333333 1.0
        1.0 0.6666666666666666 0.0
        1.0 0.6666666666666666 1.0
        1.0 1.0 0.0
        1.0 1.0 1.0
    ]

    ff = FullFactorial([4, 2])
    @test doe_samples(ff, 2) == [
        0.0 0.0
        0.0 1.0
        0.3333333333333333 0.0
        0.3333333333333333 1.0
        0.6666666666666666 0.0
        0.6666666666666666 1.0
        1.0 0.0
        1.0 1.0
    ]

    ff = FullFactorial([1, 2, 3, 4])
    @test doe_samples(ff, 4) == [
        1.0 0.0 0.0 0.0
        1.0 0.0 0.0 0.3333333333333333
        1.0 0.0 0.0 0.6666666666666666
        1.0 0.0 0.0 1.0
        1.0 0.0 0.5 0.0
        1.0 0.0 0.5 0.3333333333333333
        1.0 0.0 0.5 0.6666666666666666
        1.0 0.0 0.5 1.0
        1.0 0.0 1.0 0.0
        1.0 0.0 1.0 0.3333333333333333
        1.0 0.0 1.0 0.6666666666666666
        1.0 0.0 1.0 1.0
        1.0 1.0 0.0 0.0
        1.0 1.0 0.0 0.3333333333333333
        1.0 1.0 0.0 0.6666666666666666
        1.0 1.0 0.0 1.0
        1.0 1.0 0.5 0.0
        1.0 1.0 0.5 0.3333333333333333
        1.0 1.0 0.5 0.6666666666666666
        1.0 1.0 0.5 1.0
        1.0 1.0 1.0 0.0
        1.0 1.0 1.0 0.3333333333333333
        1.0 1.0 1.0 0.6666666666666666
        1.0 1.0 1.0 1.0
    ]

    frac = FractionalFactorial(["a", "b", "c", "ac"])
    @test frac.columns == ["a", "b", "c", "ac"]
    @test doe_samples(frac) == [
        1.0 1.0 1.0 1.0
        1.0 1.0 0.0 0.0
        1.0 0.0 1.0 1.0
        1.0 0.0 0.0 0.0
        0.0 1.0 1.0 0.0
        0.0 1.0 0.0 1.0
        0.0 0.0 1.0 0.0
        0.0 0.0 0.0 1.0
    ]

    frac = FractionalFactorial(["a", "b", "ba"])
    @test doe_samples(frac) == [1.0 1.0 1.0; 1.0 0.0 0.0; 0.0 1.0 0.0; 0.0 0.0 1.0]

    frac = FractionalFactorial(["a", "b", "c"])
    @test doe_samples(frac) == doe_samples(tlf, 3)

    ff = FullFactorial([2, 2, 2])
    @test doe_samples(tlf, 3) == doe_samples(ff)
end

@testset "BoxBehnken" begin
    bb = BoxBehnken()

    @test doe_samples(bb, 2) == [1.0 1.0; 1.0 0.0; 0.0 1.0; 0.0 0.0]
    @test doe_samples(bb, 5) == [
        1.0 1.0 0.5 0.5 0.5
        1.0 0.0 0.5 0.5 0.5
        0.0 1.0 0.5 0.5 0.5
        0.0 0.0 0.5 0.5 0.5
        1.0 0.5 1.0 0.5 0.5
        1.0 0.5 0.0 0.5 0.5
        0.0 0.5 1.0 0.5 0.5
        0.0 0.5 0.0 0.5 0.5
        1.0 0.5 0.5 1.0 0.5
        1.0 0.5 0.5 0.0 0.5
        0.0 0.5 0.5 1.0 0.5
        0.0 0.5 0.5 0.0 0.5
        1.0 0.5 0.5 0.5 1.0
        1.0 0.5 0.5 0.5 0.0
        0.0 0.5 0.5 0.5 1.0
        0.0 0.5 0.5 0.5 0.0
        0.5 1.0 1.0 0.5 0.5
        0.5 1.0 0.0 0.5 0.5
        0.5 0.0 1.0 0.5 0.5
        0.5 0.0 0.0 0.5 0.5
        0.5 1.0 0.5 1.0 0.5
        0.5 1.0 0.5 0.0 0.5
        0.5 0.0 0.5 1.0 0.5
        0.5 0.0 0.5 0.0 0.5
        0.5 1.0 0.5 0.5 1.0
        0.5 1.0 0.5 0.5 0.0
        0.5 0.0 0.5 0.5 1.0
        0.5 0.0 0.5 0.5 0.0
        0.5 0.5 1.0 1.0 0.5
        0.5 0.5 1.0 0.0 0.5
        0.5 0.5 0.0 1.0 0.5
        0.5 0.5 0.0 0.0 0.5
        0.5 0.5 1.0 0.5 1.0
        0.5 0.5 1.0 0.5 0.0
        0.5 0.5 0.0 0.5 1.0
        0.5 0.5 0.0 0.5 0.0
        0.5 0.5 0.5 1.0 1.0
        0.5 0.5 0.5 1.0 0.0
        0.5 0.5 0.5 0.0 1.0
        0.5 0.5 0.5 0.0 0.0
    ]
end

@testset "CentralComposite" begin end