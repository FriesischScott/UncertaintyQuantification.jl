<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Subset Simulation · UncertaintyQuantification.jl</title><meta name="title" content="Subset Simulation · UncertaintyQuantification.jl"/><meta property="og:title" content="Subset Simulation · UncertaintyQuantification.jl"/><meta property="twitter:title" content="Subset Simulation · UncertaintyQuantification.jl"/><meta name="description" content="Documentation for UncertaintyQuantification.jl."/><meta property="og:description" content="Documentation for UncertaintyQuantification.jl."/><meta property="twitter:description" content="Documentation for UncertaintyQuantification.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">UncertaintyQuantification.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/gettingstarted/">Getting Started</a></li><li><a class="tocitem" href="../../manual/reliability/">Reliability Analysis</a></li><li><a class="tocitem" href="../../manual/metamodels/">Metamodelling</a></li><li><a class="tocitem" href="../../manual/bayesianupdating/">Bayesian Updating</a></li><li><a class="tocitem" href="../../manual/hpc/">High Performance Computing</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/metamodels/">Metamodels</a></li><li><a class="tocitem" href="../../examples/bayesianupdating/">Bayesian Updating</a></li><li><a class="tocitem" href="../../examples/hpc/">High Performance Computing</a></li></ul></li><li><span class="tocitem">Benchmarks</span><ul><li class="is-active"><a class="tocitem" href>Subset Simulation</a><ul class="internal"><li><a class="tocitem" href="#Subset-simulation"><span>Subset simulation</span></a></li><li><a class="tocitem" href="#Example-function"><span>Example function</span></a></li></ul></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../../api/inputs/">Inputs</a></li><li><a class="tocitem" href="../../api/parameter/">Parameter</a></li><li><a class="tocitem" href="../../api/randomvariable/">RandomVariable</a></li><li><a class="tocitem" href="../../api/responsesurface/">ResponseSurface</a></li><li><a class="tocitem" href="../../api/polyharmonicspline/">PolyharmonicSpline</a></li><li><a class="tocitem" href="../../api/simulations/">Simulations</a></li><li><a class="tocitem" href="../../api/bayesianupdating/">Bayesian Updating</a></li><li><a class="tocitem" href="../../api/slurm/">SlurmInterface</a></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Benchmarks</a></li><li class="is-active"><a href>Subset Simulation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Subset Simulation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/FriesischScott/UncertaintyQuantification.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/FriesischScott/UncertaintyQuantification.jl/blob/master/docs/src/benchmarks/subset.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="High-dimensional-Subset-simulation"><a class="docs-heading-anchor" href="#High-dimensional-Subset-simulation">High dimensional Subset simulation</a><a id="High-dimensional-Subset-simulation-1"></a><a class="docs-heading-anchor-permalink" href="#High-dimensional-Subset-simulation" title="Permalink"></a></h1><h2 id="Subset-simulation"><a class="docs-heading-anchor" href="#Subset-simulation">Subset simulation</a><a id="Subset-simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Subset-simulation" title="Permalink"></a></h2><p>The implemented subset simulation algorithms <a href="../../api/simulations/#UncertaintyQuantification.SubSetSimulation"><code>SubSetSimulation</code></a> (using Metropolis-Hastings MCMC), <a href="../../api/simulations/#UncertaintyQuantification.SubSetInfinity"><code>SubSetInfinity</code></a> (conditional sampling MCMC) and <a href="@ref"><code>SubSetInfinityAdaptive</code></a> (adaptive conditional sampling MCMC), work efficiently in high dimensions. This benchmark shows how these algorithms scale with increasing number of dimension <code>N</code> and increasingly smaller target probability of failure <code>pf_target</code>.</p><h2 id="Example-function"><a class="docs-heading-anchor" href="#Example-function">Example function</a><a id="Example-function-1"></a><a class="docs-heading-anchor-permalink" href="#Example-function" title="Permalink"></a></h2><p>In this example, the test model will be sum of independent standard normal distributions</p><p class="math-container">\[f_N(X) = \sum^N_i X_i,\]</p><p>where <span>$X_i \sim \Phi(0, 1)$</span> are standard normal random variables. We will define a linear limitstate</p><p class="math-container">\[g_N(X) = C_N - f_N(X),\]</p><p>where <span>$C_N$</span> will be defined such that the failure probability <span>$\mathbb{P}(g(X) \leq 0)$</span> matches a pre-defined value <code>pf_target</code>.</p><p>We can find <span>$C_N$</span> analytically, depending on the chosen number of dimensions and target probability of failure</p><p class="math-container">\[C_N = F_{\Phi_{\sqrt{N}}}^{-1}(1 - p_{\text{target}}),\]</p><p>where <span>$F_{\Phi_{\sqrt{N}}}^{-1}$</span> is the quantile function of a Gaussian distribution, with zero mean and standard deviation <code>sqrt(N)</code>.</p><p>Since the dimension and failure probability are two parameters of this numerical experiment, we can dynamically create the required number of random variables using broadcasting</p><pre><code class="language-julia hljs">using UncertaintyQuantification

N = 2000

inputs = RandomVariable.(Normal(), [Symbol(&quot;x$i&quot;) for i in 1:N])
</code></pre><p>The model can be defined generalized for arbitrary dimensions by summing the columns of the <code>DataFrame</code>. Using <code>names(inputs)</code> to select the columns we can safely exclude any extra variables that might be present.</p><pre><code class="language-julia hljs">f = Model(
    df -&gt; sum(eachcol(df[:, names(inputs)])),
    :f
)</code></pre><p>Next, the <code>pf_target</code> and corresponding limit state are defined.</p><pre><code class="language-julia hljs">pf_target = 1e-9

fail_limit = quantile(Normal(0, sqrt(N)), 1 - pf_target)

function g(df)
    return fail_limit .- df.f
end</code></pre><p>For this benchmark, the probability of failure will be estimated using all available variants of Subset simulation</p><pre><code class="language-julia hljs">subset_MH = SubSetSimulation(2000, 0.1, 20, Uniform(-0.5, 0.5))
subset_CS = SubSetInfinity(2000, 0.1, 20, 0.5)
subset_aCS = SubSetInfinityAdaptive(2000, 0.1, 20, 200)</code></pre><div class="admonition is-info"><header class="admonition-header">Monte Carlo simulation</header><div class="admonition-body"><p>Although standard Monte Carlo simulation works independently of dimension, for a target failure probability of <span>$10^{-9}$</span>, even with a billion <span>$10^9$</span> samples it can return <span>$p_f=0$</span>.</p></div></div><p>As a first benchmark the three subset simulation algorithms are used to solve the example problem with a fixed number of dimensions <code>N=200</code> and sample size per level <code>N_samples=2000</code> for increasingly smaller target probability of failures. The following figure shows the average estimated probabilities of failure and the standard deviation resulting from 100 independent simulation runs. Note how the variance of the estimation increases for smaller <code>pf</code> values. However, in comparison, the variance of the Metropolis-Hastings variant is higher than the variance of the conditional sampling methods.</p><p><img src="../../assets/subset-pf.svg" alt="Subset simulation for smaller pfs"/></p><p>For the next benchmark, the number of dimensions remains fixed at 200 while the  number of samples is increased to estimate a target probability of failure of <span>$10^{-4}$</span>.</p><p><img src="../../assets/subset-samples.svg" alt="Subset simulation with increasing samples"/></p><p>The final benchmark uses the same fixed target <span>$p_{f} = 10^{-4}$</span> and again keeps the number of samples constant at <code>2000</code> per level. This time, the number of dimensions is increased to raise the complexity of the problem.</p><p><img src="../../assets/subset-dimensions.svg" alt="Subset simulation with increasing dimensions"/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../examples/hpc/">« High Performance Computing</a><a class="docs-footer-nextpage" href="../../api/inputs/">Inputs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Thursday 18 July 2024 14:13">Thursday 18 July 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
