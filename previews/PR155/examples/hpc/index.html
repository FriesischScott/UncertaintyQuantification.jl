<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>High Performance Computing · UncertaintyQuantification.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">UncertaintyQuantification.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/gettingstarted/">Getting Started</a></li><li><a class="tocitem" href="../../manual/reliability/">Reliability Analysis</a></li><li><a class="tocitem" href="../../manual/metamodels/">Metamodelling</a></li><li><a class="tocitem" href="../../manual/hpc/">HPC</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../metamodels/">Metamodels</a></li><li class="is-active"><a class="tocitem" href>High Performance Computing</a></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../../api/inputs/">Inputs</a></li><li><a class="tocitem" href="../../api/parameter/">Parameter</a></li><li><a class="tocitem" href="../../api/randomvariable/">RandomVariable</a></li><li><a class="tocitem" href="../../api/responsesurface/">ResponseSurface</a></li><li><a class="tocitem" href="../../api/polyharmonicspline/">PolyharmonicSpline</a></li><li><a class="tocitem" href="../../api/simulations/">Simulations</a></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>High Performance Computing</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>High Performance Computing</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/FriesischScott/UncertaintyQuantification.jl/blob/master/docs/src/examples/hpc.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p>At first we need to create an array of random variables, that will be used when evaluating the points that our desgin produces. It will also define the range of the function we want the design to fit. This is also a good time to declare the function that we are working with.</p><p>Here we will vary the model&#39;s Li6 enrichment, and radius of the tungsten layer.</p><pre><code class="language-julia hljs">using UncertaintyQuantification, DelimitedFiles

E = RandomVariable(Uniform(0.3, 0.7), :E)
R1 = RandomVariable(Uniform(8, 14), :R1)</code></pre><p>Source/Extra files are expected to be in this folder</p><pre><code class="language-julia hljs">sourcedir = joinpath(pwd(), &quot;demo/models&quot;)</code></pre><p>These files will be rendere through Mustach.jl and have values injected</p><pre><code class="language-julia hljs">sourcefile = &quot;openmc_TBR.py&quot;</code></pre><p>Dictionary to map format Strings (Formatting.jl) to variables</p><pre><code class="language-julia hljs">numberformats = Dict(:E =&gt; &quot;.8e&quot;)</code></pre><p>UQ will create subfolders in here to run the solver and store the results</p><pre><code class="language-julia hljs">workdir = joinpath(pwd(), &quot;openmc_TBR&quot;)</code></pre><p>Read output file and compute the Tritium breeding ratio An extractor is based the working directory for the current sample</p><pre><code class="language-julia hljs">TBR = Extractor(base -&gt; begin
    file = joinpath(base, &quot;openmc.out&quot;)
    data = readdlm(file, &#39; &#39;)

    return data[1]
end, :TBR)</code></pre><p>In this example, an OpenMC model is built and run using the python API. We therefore specify the python3 command, and the python file to run</p><pre><code class="language-julia hljs">openmc = Solver(
    &quot;python3&quot;, # path to python3 binary
    &quot;openmc_TBR.py&quot;;
    args=&quot;&quot;, # (optional) extra arguments passed to the solver
)</code></pre><p>Slurm interface, passing requiring machine information. Note in <code>extras</code>, we specify the commands we rquire to run the model (for example, loading modulefiles or data)</p><pre><code class="language-julia hljs">slurm = SlurmInterface(;
    jobname=&quot;UQ_slurm&quot;,
    account=&quot;EXAMPLE-0001-CPU&quot;,
    partition=&quot;cpu_parition&quot;,
    nodes=1,
    ntasks=1,
    throttle=50,
    time=&quot;00:01:00&quot;,    # Time per simulation
    extras=[&quot;module load openmc&quot;, &quot;source ~/.virtualenvs/openmc/bin/activate&quot;],
)</code></pre><p>Define external model, passing slurm interface</p><pre><code class="language-julia hljs">ext = ExternalModel(
    sourcedir, sourcefile, TBR, openmc; workdir=workdir, formats=numberformats, scheduler=slurm
)</code></pre><p>Specify a limitstate function, negative value consititutes failure. Here we are interested in P(TBR &lt;= 1).</p><pre><code class="language-julia hljs">function limitstate(df)
    return  reduce(vcat, df.TBR) .- 1
end</code></pre><p>Run a Monte Carlo simulation</p><pre><code class="language-julia hljs">@time pf, cov, samples = probability_of_failure(ext, limitstate, [E, R1], MonteCarlo(5000))
println(&quot;Probability of failure: $pf&quot;)</code></pre><p>Gives <code>pf = 0.0064</code>, <code>cov = 0.1762</code> for <code>5000</code> samples. Also <code>TBR mean = 1.2404114576444423</code>, <code>TBR std = 0.10000460056126671</code>, and <code>TBR 95%: [1.0379178446904211, 1.4130216792418262]</code>.</p><p>We can also try with Subset simulation</p><pre><code class="language-julia hljs">subset = SubSetInfinity(800, 0.1, 10, 0.5)

@time pf, cov, samples = probability_of_failure(ext, limitstate, [E, R1], subset)
println(&quot;Probability of failure: $pf&quot;)</code></pre><p>Giving <code>pf = 0.0053</code>, <code>cov = 0.2138</code> for <code>2400</code> samples.</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../metamodels/">« Metamodels</a><a class="docs-footer-nextpage" href="../../api/inputs/">Inputs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Monday 19 February 2024 14:08">Monday 19 February 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
