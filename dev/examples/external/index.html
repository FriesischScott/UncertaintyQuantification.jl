<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>External Models · UncertaintyQuantification.jl</title><meta name="title" content="External Models · UncertaintyQuantification.jl"/><meta property="og:title" content="External Models · UncertaintyQuantification.jl"/><meta property="twitter:title" content="External Models · UncertaintyQuantification.jl"/><meta name="description" content="Documentation for UncertaintyQuantification.jl."/><meta property="og:description" content="Documentation for UncertaintyQuantification.jl."/><meta property="twitter:description" content="Documentation for UncertaintyQuantification.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">UncertaintyQuantification.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/introduction/">Introduction</a></li><li><a class="tocitem" href="../../manual/gettingstarted/">Getting Started</a></li><li><a class="tocitem" href="../../manual/reliability/">Reliability Analysis</a></li><li><a class="tocitem" href="../../manual/metamodels/">Metamodelling</a></li><li><a class="tocitem" href="../../manual/simulations/">Simulations</a></li><li><a class="tocitem" href="../../manual/bayesianupdating/">Bayesian Updating</a></li><li><a class="tocitem" href="../../manual/parallelisation/">Parallelisation</a></li><li><a class="tocitem" href="../../manual/hpc/">High Performance Computing</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li class="is-active"><a class="tocitem" href>External Models</a><ul class="internal"><li><a class="tocitem" href="#OpenSees-supported-beam"><span>OpenSees supported beam</span></a></li><li><a class="tocitem" href="#OpenSees-supported-beam-parallel"><span>OpenSees supported beam parallel</span></a></li></ul></li><li><a class="tocitem" href="../metamodels/">Metamodels</a></li><li><a class="tocitem" href="../bayesianupdating/">Bayesian Updating</a></li><li><a class="tocitem" href="../hpc/">High Performance Computing</a></li></ul></li><li><span class="tocitem">Benchmarks</span><ul><li><a class="tocitem" href="../../benchmarks/subset/">Subset Simulation</a></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../../api/inputs/">Inputs</a></li><li><a class="tocitem" href="../../api/models/">Models</a></li><li><a class="tocitem" href="../../api/responsesurface/">ResponseSurface</a></li><li><a class="tocitem" href="../../api/polyharmonicspline/">PolyharmonicSpline</a></li><li><a class="tocitem" href="../../api/simulations/">Simulations</a></li><li><a class="tocitem" href="../../api/bayesianupdating/">Bayesian Updating</a></li><li><a class="tocitem" href="../../api/slurm/">SlurmInterface</a></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>External Models</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>External Models</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/FriesischScott/UncertaintyQuantification.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/FriesischScott/UncertaintyQuantification.jl/blob/master/docs/src/examples/external.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="External-Solvers"><a class="docs-heading-anchor" href="#External-Solvers">External Solvers</a><a id="External-Solvers-1"></a><a class="docs-heading-anchor-permalink" href="#External-Solvers" title="Permalink"></a></h1><h2 id="OpenSees-supported-beam"><a class="docs-heading-anchor" href="#OpenSees-supported-beam">OpenSees supported beam</a><a id="OpenSees-supported-beam-1"></a><a class="docs-heading-anchor-permalink" href="#OpenSees-supported-beam" title="Permalink"></a></h2><p>In this example we will perform the reliability analysis of a supported beam using the open-source finite element software <a href="https://opensees.berkeley.edu/">OpenSees</a>. The example definition can be found <a href="https://opensees.berkeley.edu/wiki/index.php/Simply_supported_beam_modeled_with_two_dimensional_solid_elements">here</a> We will be modeling the Young&#39;s modulus of the <code>ElasticIsotropic</code> material in the OpenSees model as a <code>RandomVariable</code>.</p><pre><code class="language-julia hljs">using UncertaintyQuantification
using DelimitedFiles # required to extract the simulation output

E = RandomVariable(Normal(1000, 5), :E) # Young&#39;s modulus</code></pre><p>Source/Extra files are expected to be in this folder</p><pre><code class="language-julia hljs">sourcedir = joinpath(pwd(), &quot;demo/models&quot;)</code></pre><p>These files will be rendere through Mustache.jl and have values injected</p><pre><code class="language-julia hljs">sourcefile = &quot;supported-beam.tcl&quot;</code></pre><p>Dictionary to map format Strings (Format.jl) to variables</p><pre><code class="language-julia hljs">numberformats = Dict(:E =&gt; &quot;.8e&quot;)</code></pre><p>UQ will create subfolders in here to run the solver and store the results</p><pre><code class="language-julia hljs">workdir = joinpath(pwd(), &quot;supported-beam&quot;)</code></pre><p>Read output file and compute maximum (absolute) displacement. The input <code>base</code> of the function used to construct the <code>Extractor</code> is the working directory for the current sample.</p><pre><code class="language-julia hljs">disp = Extractor(base -&gt; begin
    file = joinpath(base, &quot;displacement.out&quot;)
    data = readdlm(file, &#39; &#39;)

    return maximum(abs.(data[:, 2]))
end, :disp)</code></pre><p>Define the solver</p><pre><code class="language-julia hljs">opensees = Solver(
    &quot;OpenSees&quot;, # path to OpenSees binary, here we expect it to be available on the system PATH
    &quot;supported-beam.tcl&quot;;
    args=&quot;&quot;, # (optional) extra arguments passed to the solver
)</code></pre><p>Put everything together to construct the external model</p><pre><code class="language-julia hljs">ext = ExternalModel(
    sourcedir, sourcefile, disp, opensees; workdir=workdir, formats=numberformats
)</code></pre><p>Run the probability of failure analysis with 1000 samples</p><pre><code class="language-julia hljs">pf, samples = probability_of_failure(ext, df -&gt; 0.35 .- df.disp, E, MonteCarlo(1000))

println(&quot;Probability of failure: $pf&quot;)</code></pre><p>Running large simulations with an external model in series can be numerically demanding. The next example shows how to run the same example but execute the model in parallel.</p><h2 id="OpenSees-supported-beam-parallel"><a class="docs-heading-anchor" href="#OpenSees-supported-beam-parallel">OpenSees supported beam parallel</a><a id="OpenSees-supported-beam-parallel-1"></a><a class="docs-heading-anchor-permalink" href="#OpenSees-supported-beam-parallel" title="Permalink"></a></h2><p>load the Distributed module</p><pre><code class="language-julia hljs">using Distributed</code></pre><p>add six local workers</p><pre><code class="language-julia hljs">addprocs(6)</code></pre><p>The setup of the example is enclosed in the @everywhere macro. This ensures, that the main process and all worker processes have loaded the necessary modules and received all defined variables and functions. Apart from this, the setup is identical to the serial example.</p><pre><code class="language-julia hljs">@everywhere begin
    using UncertaintyQuantification, DelimitedFiles

    E = RandomVariable(Normal(1000, 5), :E)

    sourcedir = joinpath(pwd(), &quot;demo/models&quot;)

    sourcefile = &quot;supported-beam.tcl&quot;

    numberformats = Dict(:E =&gt; &quot;.8e&quot;)

    workdir = joinpath(pwd(), &quot;supported-beam&quot;)

    disp = Extractor(base -&gt; begin
        file = joinpath(base, &quot;displacement.out&quot;)
        data = readdlm(file, &#39; &#39;)

        return maximum(abs.(data[:, 2]))
    end, :disp)

    opensees = Solver(&quot;OpenSees&quot;, &quot;supported-beam.tcl&quot;; args=&quot;&quot;)

    ext = ExternalModel(
        sourcedir, sourcefile, disp, opensees; workdir=workdir, formats=numberformats
    )
end</code></pre><p>The analysis is then executed on the main Julia process. When executing the model, the calls to the external solver will automatically be distributed to all available workers.</p><pre><code class="language-julia hljs">pf, samples = probability_of_failure(ext, df -&gt; 0.35 .- df.disp, E, MonteCarlo(1000))

println(&quot;Probability of failure: $pf&quot;)</code></pre><blockquote><p><strong>Note</strong></p><p>Local parallelisation will quickly reach it&#39;s limits for large and complex models. Making use of  cluster thrugh the <code>SlurmInterface</code> is strongly recommended.</p></blockquote><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../manual/hpc/">« High Performance Computing</a><a class="docs-footer-nextpage" href="../metamodels/">Metamodels »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Monday 28 October 2024 11:59">Monday 28 October 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
